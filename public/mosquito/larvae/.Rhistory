geoCode <- function(address,verbose=FALSE) {
if(verbose) cat(address,"\n")
u <- url(address)
doc <- getURL(u)
x <- fromJSON(doc,simplify = FALSE)
if(x$status=="OK") {
lat <- x$results[[1]]$geometry$location$lat
lng <- x$results[[1]]$geometry$location$lng
location_type <- x$results[[1]]$geometry$location_type
formatted_address <- x$results[[1]]$formatted_address
return(c(lat, lng, location_type, formatted_address))
} else {
return(c(NA,NA,NA, NA))
}
}
address <- paste0(lar$site, ", Gainesville, FL")
address
locations <- ldply(address, function(x) geoCode(x))
lar <- cbind(lar, locations)
head(lar)
names(locations) <- c("lat","lon","location_type", "forAddress")
# CBIND IT ALL TOGETHER
lar <- cbind(lar, locations)
lar
setwd("E:/fdoh/public/mosquito/larvae")
lar <- read.csv("july2014.csv", skip=1)
#############
# READ IN LAT LONG SCRIPT FROM GOOGLE
#############
#### This script uses RCurl and RJSONIO to download data from Google's API:
#### Latitude, longitude, location type (see explanation at the end), formatted address
#### Notice ther is a limit of 2,500 calls per day
library(RCurl)
library(RJSONIO)
library(plyr)
url <- function(address, return.call = "json", sensor = "false") {
root <- "http://maps.google.com/maps/api/geocode/"
u <- paste(root, return.call, "?address=", address, "&sensor=", sensor, sep = "")
return(URLencode(u))
}
geoCode <- function(address,verbose=FALSE) {
if(verbose) cat(address,"\n")
u <- url(address)
doc <- getURL(u)
x <- fromJSON(doc,simplify = FALSE)
if(x$status=="OK") {
lat <- x$results[[1]]$geometry$location$lat
lng <- x$results[[1]]$geometry$location$lng
location_type <- x$results[[1]]$geometry$location_type
formatted_address <- x$results[[1]]$formatted_address
return(c(lat, lng, location_type, formatted_address))
} else {
return(c(NA,NA,NA, NA))
}
}
# Use plyr to getgeocoding for a vector
address <- paste0(lar$site, ", Gainesville, FL")
locations <- ldply(address, function(x) geoCode(x))
names(locations) <- c("lat","lon","location_type", "forAddress")
# CBIND IT ALL TOGETHER
lar <- cbind(lar, locations)
###################
#LOAD  PACKAGES
###################
library(RColorBrewer)
library(xtable)
library(gdata)
library(plyr)
library(maps)
library(mapdata)
library(maptools)
library(RColorBrewer)
library(rJava)
library(OpenStreetMap)
library(rgdal)
library(shapefiles)
library(SemiPar)
library(wordcloud)
library(RCurl)
library(classInt)
# MAP OF ALACHUA COUNTY
joewatercolor <- openmap(c(29.96, -82.7), c(29.35,-81.9),
type="stamen-watercolor")
joemapwatercolor <- openproj(joewatercolor, projection = "+proj=longlat")
plot(joemapwatercolor)
names(lar)
summary(lar$larvae_per_dip)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.2),
cex = lar$larvae_per_dip / 2)
summary(lar$lat)
lar$lat <- as.numeric(lar$lat)
lar$lon <- as.numeric(lar$lon)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.2),
cex = lar$larvae_per_dip / 2)
View(lar)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.2),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.2),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
points(x = lar$lon[which(is.na(lar$larvae_per_dip))],
y = lar$lat[which(is.na(lar$larvae_per_dip))],
col = adjustcolor("black", alpha.f=0.2),
cex = lar$larvae_per_dip[which(is.na(lar$larvae_per_dip))] / 2,
pch=16)
points(x = lar$lon[which(is.na(lar$larvae_per_dip))],
y = lar$lat[which(is.na(lar$larvae_per_dip))],
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
map("county","florida")
map("county","florida",
xlim=c(-82.7, -81.9),
ylim=c(29.35, 29.96))
points(x = lar$lon[which(is.na(lar$larvae_per_dip))],
y = lar$lat[which(is.na(lar$larvae_per_dip))],
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.4),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
plot(joemapwatercolor)
map("county","florida",
xlim=c(-82.7, -81.9),
ylim=c(29.35, 29.96),
col=c(NA, rep("white", 67)),
add=TRUE)
map("county","florida",
xlim=c(-82.7, -81.9),
ylim=c(29.35, 29.96),
fill=c(NA, rep("white", 67)),
add=TRUE)
map("county","florida",
xlim=c(-82.7, -81.9),
ylim=c(29.35, 29.96),
col=c(NA, rep("white", 67)),
add=TRUE,
border=FALSE)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = lar$lon[which(is.na(lar$larvae_per_dip))],
y = lar$lat[which(is.na(lar$larvae_per_dip))],
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.4),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
points(x = lar$lon[which(!is.na(lar$larvae_per_dip))],
y = lar$lat[which(!is.na(lar$larvae_per_dip))],
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
jitter(c(1,2,3,4,5), factor=1)
jitter(c(1,2,3,4,5), factor=2)
jitter(c(1,2,3,4,5), factor=10)
jitter(c(1,2,3,4,5), factor=1)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))]),
y = lar$lat[which(is.na(lar$larvae_per_dip))],
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))]),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))]),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))]),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))]),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
jitter(lar$lat[which(is.na(lar$larvae_per_dip))])
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=10),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))]),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=100),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))]),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=50),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=50),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=50),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=50),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=10),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=10),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=10),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=10),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.2),
cex = 1,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.8),
cex = 0.4,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
legend(x="bottomleft",
pch=16,
col=adjustcolor("black", alpha.f=0.6),
legend = "Trap site",
bty="n",
pt.cex=0.6)
legend(x="bottom",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
main="Larvae per dip")
legend(x="bottom",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
title="Larvae per dip")
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.6),
cex = 0.6,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
legend(x="bottomleft",
pch=16,
col=adjustcolor("black", alpha.f=0.6),
legend = "Trap site",
bty="n",
pt.cex=0.6)
legend(x="bottom",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
title="Larvae per dip",
ncol=2)
title(main="July 2014: Inspections and Larvaciding")
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.6),
cex = 0.6,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
legend(x="bottom",
pch=16,
col=adjustcolor("black", alpha.f=0.6),
legend = "Trap site",
bty="n",
pt.cex=0.6)
legend(x="bottomleft",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
title="Larvae per dip",
ncol=2)
title(main="July 2014: Inspections and Larvaciding")
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.6),
cex = 0.6,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
legend(x="bottom",
pch=16,
col=adjustcolor("black", alpha.f=0.6),
legend = "Trap site",
bty="n",
pt.cex=0.6)
legend(x="bottomleft",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
title="Larvae per dip",
ncol=2)
title(main="July 2014: Inspections and Larvaciding")
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.6),
cex = 0.6,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
legend(x="bottom",
pch=16,
col=adjustcolor("black", alpha.f=0.6),
legend = "Trap site",
bty="n",
pt.cex=0.6)
legend(x="bottomleft",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
title="Larvae per dip",
ncol=2)
title(main="July 2014: Inspections and Larvaciding")
plot(joemapwatercolor)
alachuacol <- NA
countycols <- rep("white", 67)
map("county", "florida",
fill=TRUE,
col=c(alachuacol,countycols),
xlim=c(-82.75,-82),
ylim=c(29.3,30.1),
border="white",
add=T)
points(x = jitter(lar$lon[which(is.na(lar$larvae_per_dip))], factor=5),
y = jitter(lar$lat[which(is.na(lar$larvae_per_dip))], factor=5),
col = adjustcolor("black", alpha.f=0.6),
cex = 0.6,
pch=16)
points(x = jitter(lar$lon[which(!is.na(lar$larvae_per_dip))], factor=1),
y = jitter(lar$lat[which(!is.na(lar$larvae_per_dip))], factor=1),
col = adjustcolor("darkred", alpha.f=0.6),
cex = lar$larvae_per_dip[which(!is.na(lar$larvae_per_dip))] / 2,
pch=16)
legend(x="bottom",
pch=16,
col=adjustcolor("black", alpha.f=0.6),
legend = "Trap site",
bty="n",
pt.cex=0.6)
legend(x="bottomleft",
pch=16,
col=adjustcolor("darkred", alpha.f=0.6),
legend = c(2,4,6,8),
bty="n",
pt.cex=c(2,4,6,8)/2,
title="Larvae per dip",
ncol=2)
title(main="July 2014: Inspections and Larvaciding")
